# Intermediate Files: formats and sources

- [Intermediate Files: formats and sources](#intermediate-files-formats-and-sources)
  - [0. genomic profiles](#0-genomic-profiles)
  - [1. obtain number of deleterious mutations per genomic window](#1-obtain-number-of-deleterious-mutations-per-genomic-window)
  - [1.A Islands of diversity](#1a-islands-of-diversity)
    - [1.A.1 Isolates data from islands and combine with mutaion count data](#1a1-isolates-data-from-islands-and-combine-with-mutaion-count-data)
    - [1.A.2 Summarise raw data (1.A.1) per generation and replicate](#1a2-summarise-raw-data-1a1-per-generation-and-replicate)
    - [1.A.3 Bootstrap summarised data (1.A.2)](#1a3-bootstrap-summarised-data-1a2)
    - [1.A.4 plotting bootstrapped results](#1a4-plotting-bootstrapped-results)
  - [1.B](#1b)
    - [1.B.1 proportion table used to produce Figure 5](#1b1-proportion-table-used-to-produce-figure-5)


## 0. genomic profiles
Genome windowed and calculate Pi based on allele counts (obtained from VCF files)
file name example: `genomic_profile_%s.txt.gz`

Scripts and more detailed info: see https://github.com/CMPG/genomicSurfing (items 2.1 through 2.5)
- 02_get_allele_counts_for_pi_calcul.sh
- 02_slurm_get_allele_counts_for_pi_calcul.sh
- 03_SLURM_Get_Pi_Profile.sh
- 03b_SLURM_conCAT_replicate_files.sh
- 03_FUNCTIONS_Get_Pi_Profile.R
- 03_Get_Pi_Profile.R

| gen   | cpop | rep | mean_pi_raw          | mean_pi_samp         | w_id  |
| ----- | ---- | --- | -------------------- | -------------------- | ----- |
| 25002 | 6    | 183 | 0.00016              | 0.00016271186440678  | 1     |
| 25002 | 6    | 183 | 5.35555555555556e-05 | 5.44632768361582e-05 | 2     |
| 25002 | 6    | 183 | 0.000177944444444444 | 0.000180960451977401 | 3     |
| 25002 | 6    | 183 | 0.000258444444444444 | 0.000262824858757062 | 4     |
| ...   | ...  | ... | ...                  | ...                  | ...   |
| 25002 | 6    | 183 | 0.000145222222222222 | 0.000147683615819209 | 13331 |
| 25002 | 6    | 183 | 0.000194833333333333 | 0.000198135593220339 | 13332 |
| 25002 | 6    | 183 | 0.000120055555555556 | 0.000122090395480226 | 13333 |
| 25002 | 6    | 183 | 0.000112622222222222 | 0.000114531073446328 | 13334 |
| ...   | ...  | ... | ...                  | ...                  | ...   |
| 25402 | 86   | 183 | 2.92345679012346e-05 | 2.95630461922597e-05 | 13326 |
| 25402 | 86   | 183 | 2.92345679012346e-05 | 2.95630461922597e-05 | 13327 |
| ...   | ...  | ... | ...                  | ...                  | ...   |
| 25402 | 86   | 183 | 0                    | 0                    | 13333 |
| 25402 | 86   | 183 | 0                    | 0                    | 13334 |
| 25407 | 87   | 183 | 3.51604938271603e-06 | 3.55555555555553e-06 | 1     |
| ...   | ...  | ... | ...                  | ...                  | ...   |
| 25407 | 87   | 183 | 3.33086419753086e-05 | 3.36828963795256e-05 | 6     |
| 25407 | 87   | 183 | 3.33086419753086e-05 | 3.36828963795256e-05 | 7     |
| 25407 | 87   | 183 | 0                    | 0                    | 8     |
| ...   | ...  | ... | ...                  | ...                  | ...   |
| 25497 | 105  | 183 | 1.03111111111111e-05 | 1.04269662921348e-05 | 1     |
| 25497 | 105  | 183 | 0                    | 0                    | 2     |
| 25497 | 105  | 183 | 0                    | 0                    | 3     |
| ...   | ...  | ... | ...                  | ...                  | ...   |
| 25497 | 105  | 183 | 0                    | 0                    | 13332 |
| 25497 | 105  | 183 | 0                    | 0                    | 13333 |
| 25497 | 105  | 183 | 0                    | 0                    | 13334 |


## 1. obtain number of deleterious mutations per genomic window
genomic profile + VCF files ⏭ **mutCountsALL_wID_alleleC_gScan_%%**
script: b11_getMasterTable_alleleC_mutsC.R
example: mutCountsALL_wID_alleleC_gScan_ancBGS_h010_sc0015_noRecovery_p2_20Mb.txt

| "w_id" | "gen"  | "rep" | "mean_pi_raw"        | "ini"    | "end"    | "mid_win" | "mutCount" | "POS"    | "alleleC" |
|:-------|:-------|:------|:---------------------|:---------|:---------|:----------|:-----------|:---------|:----------|
| 1334   | 100005 | 1     | 0.0005491875         | 9993751  | 10003751 | 9998751   | 0          | NA       | NA        |
| 1335   | 100005 | 1     | 0.0005475625         | 10001251 | 10011251 | 10006251  | 0          | NA       | NA        |
| 1336   | 100005 | 1     | 9.8375e-05           | 10008751 | 10018751 | 10013751  | 0          | NA       | NA        |
| 1337   | 100005 | 1     | 0.0002596875         | 10016251 | 10026251 | 10021251  | 0          | NA       | NA        |
| 1338   | 100005 | 1     | 0.0002966875         | 10023751 | 10033751 | 10028751  | 1          | 10031714 | 4         |
| 1339   | 100005 | 1     | 0.00014915625        | 10031251 | 10041251 | 10036251  | 1          | 10031714 | 4         |
| 1340   | 100005 | 1     | 0.0002344375         | 10038751 | 10048751 | 10043751  | 0          | NA       | NA        |
| 1341   | 100005 | 1     | 0.00035290625        | 10046251 | 10056251 | 10051251  | 1          | 10051552 | 3         |
| 1342   | 100005 | 1     | 0.00023421875        | 10053751 | 10063751 | 10058751  | 2          | 10057006 | 1         |
| 1342   | 100005 | 1     | 0.00023421875        | 10053751 | 10063751 | 10058751  | 2          | 10057099 | 7         |
| 1343   | 100005 | 1     | 0.00030034375        | 10061251 | 10071251 | 10066251  | 1          | 10064808 | 3         |
| ...    | ...    | ...   | ...                  | ...      | ...      | ...       | ...        | ...      | ...       |
| 2658   | 100380 | 22    | 0                    | 19923751 | 19933751 | 19928751  | 0          | NA       | NA        |
| 2659   | 100380 | 22    | 0                    | 19931251 | 19941251 | 19936251  | 0          | NA       | NA        |
| 2660   | 100380 | 22    | 0                    | 19938751 | 19948751 | 19943751  | 0          | NA       | NA        |
| 2661   | 100380 | 22    | 0                    | 19946251 | 19956251 | 19951251  | 0          | NA       | NA        |
| 2662   | 100380 | 22    | 0                    | 19953751 | 19963751 | 19958751  | 0          | NA       | NA        |
| 2663   | 100380 | 22    | 9.50000000000001e-06 | 19961251 | 19971251 | 19966251  | 0          | NA       | NA        |
| 2664   | 100380 | 22    | 9.50000000000001e-06 | 19968751 | 19978751 | 19973751  | 0          | NA       | NA        |
| 2665   | 100380 | 22    | 0                    | 19976251 | 19986251 | 19981251  | 0          | NA       | NA        |
| 2666   | 100380 | 22    | 0                    | 19983751 | 19993751 | 19988751  | 0          | NA       | NA        |
| 2667   | 100380 | 22    | 0                    | 19991251 | 20000001 | 19995626  | 0          | NA       | NA        |

## 1.A Islands of diversity

### 1.A.1 Isolates data from islands and combine with mutaion count data

from mutCountsALL ⏭ **ilhasOfDiv** 
script: b12_getIlhasTroughs_countMuts.R
example: ilhasOfDiv_ancBGS_h010LoRec_sc0015_noRecovery_p2_20Mb_gScan_p2_r1-100.txt


| "w_id" | "gen"  | "rep" | "mean_pi_raw" | "ini"    | "end"    | "mid_win" | "mutCount" | "il_id" |
| :----- | :----- | :---- | :------------ | :------- | :------- | :-------- | :--------- | :------ |
|        |        |       |               |          |          |           |            |         |
|...     |...     |...    |...            |...       |...       |...        |...         |...      |
| 1334   | 100005 | 1     | 0.00049084375 | 9993751  | 10003751 | 9998751   | 0          | 1       |
| 1335   | 100005 | 1     | 0.00053825    | 10001251 | 10011251 | 10006251  | 0          | 1       |
| 1336   | 100005 | 1     | 0.00085825    | 10008751 | 10018751 | 10013751  | 0          | 1       |
| 1339   | 100005 | 1     | 0.00069228125 | 10031251 | 10041251 | 10036251  | 0          | 1       |
| 1340   | 100005 | 1     | 0.00056590625 | 10038751 | 10048751 | 10043751  | 0          | 1       |
| 2564   | 100380 | 100   | 0.00019359375 | 19218751 | 19228751 | 19223751  | 0          | 85      |
| 2565   | 100380 | 100   | 0.000349625   | 19226251 | 19236251 | 19231251  | 0          | 85      |
| 2566   | 100380 | 100   | 0.000154875   | 19233751 | 19243751 | 19238751  | 0          | 85      |
| 2567   | 100380 | 100   | 0.00011615625 | 19241251 | 19251251 | 19246251  | 0          | 85      |
| 2571   | 100380 | 100   | 7.74375e-05   | 19271251 | 19281251 | 19276251  | 0          | 86      |
| 2585   | 100380 | 100   | 4.840625e-05  | 19376251 | 19386251 | 19381251  | 0          | 88      |
| 2596   | 100380 | 100   | 7.74375e-05   | 19458751 | 19468751 | 19463751  | 0          | 89      |
| 2605   | 100380 | 100   | 7.74375e-05   | 19526251 | 19536251 | 19531251  | 0          | 90      |
| 2661   | 100380 | 100   | 8.259375e-05  | 19946251 | 19956251 | 19951251  | 0          | 91      |
| 1337   | 100005 | 1     | 0.0008074375  | 10016251 | 10026251 | 10021251  | 1          | 1       |
| 1341   | 100005 | 1     | 0.0001595625  | 10046251 | 10056251 | 10051251  | 1          | 1       |
| 1342   | 100005 | 1     | 0.00020284375 | 10053751 | 10063751 | 10058751  | 1          | 1       |
| 2578   | 100380 | 100   | 7.74375e-05   | 19323751 | 19333751 | 19328751  | 1          | 87      |
| 1338   | 100005 | 1     | 0.0006719375  | 10023751 | 10033751 | 10028751  | 2          | 1       |

### 1.A.2 Summarise raw data (1.A.1) per generation and replicate
from mutCountsALL ⏭ **summaIlhasOfDiv**
script: b12_getIlhasTroughs_countMuts.R
example: summaIlhasOfDiv_ancBGS_h010LoRec_sc0001_noRecovery_p2_20Mb_gScan_p2_r6-10.txt

| "il_id" | "rep" | "gen"  | "n_windows" | "mp_raw"             | "ini"    | "end"    | "mid_il"         | "mutCount" | "size"   | "totIl" |
| :------ | :---- | :----- | :---------- | :------------------- | :------- | :------- | :--------------- | :--------- | :------- | :------ |
| 1       | 6     | 100025 | 1334        | 0.000777446187620475 | 9993751  | 20000001 | 14997500.5314843 | 2134       | 10006250 | 1       |
| 1       | 7     | 100025 | 315         | 0.000860062174036281 | 9993751  | 12358751 | 11176251         | 581        | 2365000  | 10      |
| 2       | 7     | 100025 | 36          | 0.0006276640625      | 12363751 | 12636251 | 12500001         | 35         | 272500   | 10      |
| 3       | 7     | 100025 | 53          | 0.000493521816037736 | 12641251 | 13041251 | 12841251         | 43         | 400000   | 10      |
| 4       | 7     | 100025 | 5           | 0.0001765375         | 13053751 | 13093751 | 13073751         | 4          | 40000    | 10      |
| 5       | 7     | 100025 | 77          | 0.000834535308441558 | 13098751 | 13678751 | 13388751         | 152        | 580000   | 10      |
| 6       | 7     | 100025 | 247         | 0.000752194078947368 | 13691251 | 15546251 | 14618751         | 392        | 1855000  | 10      |
| 7       | 7     | 100025 | 525         | 0.000725220119047619 | 15551251 | 19491251 | 17521251         | 837        | 3940000  | 10      |
|...      |...    |...     |...          |...                   |...       |...       |...               |...         |...       |...      |
| 1       | 10    | 100035 | 276         | 0.000824575375258799 | 9993751  | 12066251 | 11030001         | 463        | 2072500  | 11      |
| 2       | 10    | 100035 | 27          | 0.000435725694444444 | 12071251 | 12276251 | 12173751         | 15         | 205000   | 11      |
| 3       | 10    | 100035 | 5           | 0.00015003125        | 12281251 | 12321251 | 12301251         | 2          | 40000    | 11      |
| 4       | 10    | 100035 | 11          | 0.000498423295454545 | 12341251 | 12426251 | 12383751         | 13         | 85000    | 11      |
| 5       | 10    | 100035 | 420         | 0.000821235491071429 | 12431251 | 15583751 | 14007501         | 732        | 3152500  | 11      |
| 6       | 10    | 100035 | 34          | 0.000539415441176471 | 15588751 | 15846251 | 15717501         | 24         | 257500   | 11      |
| 7       | 10    | 100035 | 50          | 0.00044119375        | 15881251 | 16258751 | 16070001         | 59         | 377500   | 11      |
| 8       | 10    | 100035 | 80          | 0.0007166859375      | 16263751 | 16866251 | 16565001         | 116        | 602500   | 11      |
| 9       | 10    | 100035 | 4           | 0.0001827890625      | 16871251 | 16903751 | 16887501         | 2          | 32500    | 11      |
| 10      | 10    | 100035 | 367         | 0.000824575698228883 | 16916251 | 19671251 | 18293751         | 686        | 2755000  | 11      |
| 11      | 10    | 100035 | 43          | 0.000686556893687708 | 19676251 | 20000001 | 19838736.4651163 | 80         | 323750   | 11      |
|...      |...    |...     |...          |...                   |...       |...       |...               |...         |...       |...      |



### 1.A.3 Bootstrap summarised data (1.A.2)

"summaIlhas*1-100.txt" ⏭ **boot%sx_ILHAS_%s_sc%s_%sMb_%s.txt**
script: bootIlhasDiversity.R
example: boot10000x_ILHAS_size_sc0015_20Mb_10K.txt

| "iter" | "gen"  | "size"           |
| :----- | :----- | :--------------- |
| 1      | 100005 | 3601663.42412451 |
| 2      | 100005 | 3780121.59533074 |
| 3      | 100005 | 3604392.0233463  |
| 4      | 100005 | 3577738.32684825 |
| 5      | 100005 | 4178861.86770428 |
|...     |...     |...               |
| 9990   | 100380 | 72009.4653883653 |
| 9991   | 100380 | 70872.1969450764 |
| 9992   | 100380 | 71489.6815079623 |
| 9993   | 100380 | 72464.6571335717 |
| 9994   | 100380 | 75300.2112447189 |
| 9995   | 100380 | 73637.6746831329 |
| 9996   | 100380 | 72868.2564185895 |
| 9997   | 100380 | 74453.6074098148 |
| 9998   | 100380 | 72288.95840104   |
| 9999   | 100380 | 69965.8758531037 |
| 10000  | 100380 | 70898.8056548586 |


### 1.A.4 plotting bootstrapped results
boot%sx_ILHAS_%s_sc%s_%sMb_%s.txt  ⏭ **Supp. Fig. 8**
script: 00v2_wABlines_MS02_Ilhas.R (plotting)




## 1.B
### 1.B.1 proportion table used to produce Figure 5

mutCountsALL_wID_alleleC_gScan_%s.txt ⏭ **propTable_h010_s0.0015_20Mb.txt**

Scripts:
- calculation: 0v2.2_onlyOpenData_MultiModel.R
- plotting: 0v2.6_onlyPDF_PropPlot_MultiModel_withTroughWhite.R
- save data: 0v2.5_write2File_PropPlot_MultiModel.R

| "gen" | "ilha0"             | "ilha1"             | "ilha2Mais"          | "trou0"              | "trou1"              | "trou2Mais"          |
| :---- | :------------------ | :------------------ | :------------------- | :------------------- | :------------------- | :------------------- |
| "5"   | 0.00542521502406691 | 0.00465961098398169 | 0.0030564980667561   | 1.19348220626529e-05 | 3.84676083011126e-06 | 7.89079144638207e-07 |
| "10"  | 0.00644085851810937 | 0.00443117257160893 | 0.00224729740392961  | 3.08727215339699e-05 | 7.00307740866409e-06 | 6.90444251558431e-07 |
| "15"  | 0.00710062731791999 | 0.00418606486230569 | 0.00179466187958652  | 6.40140456087746e-05 | 1.1441647597254e-05  | 1.08498382387753e-06 |
| "20"  | 0.00756746626686657 | 0.00397656434940425 | 0.00148790736210842  | 0.000110273810463189 | 1.47952339619664e-05 | 8.87714037717983e-07 |
| "25"  | 0.00798784818117257 | 0.00373333070306952 | 0.00123461295667955  | 0.000179811410084431 | 2.15024066913911e-05 | 7.89079144638207e-07 |
| "30"  | 0.00823621084194745 | 0.00355884557721139 | 0.0010827152213367   | 0.00025526710329046  | 2.38696441253058e-05 | 9.86348930797759e-07 |
|       |                     |                     |                      |                      |                      |                      |
| "360" | 0.00471277519135169 | 0.00103487729819301 | 0.000144894657934191 | 0.00714412530576817  | 0.000118361871695731 | 2.8604118993135e-06  |
| "365" | 0.00464767616191904 | 0.00103112917225598 | 0.000144204213682632 | 0.00721326836581709  | 0.000120433204450406 | 1.18361871695731e-06 |
| "370" | 0.00467134853625819 | 0.00102037796891028 | 0.000143119229858755 | 0.00721386017517557  | 0.000107512033456956 | 1.67679318235619e-06 |
| "375" | 0.00458622662353034 | 0.00100972540045767 | 0.000142034246034877 | 0.00730864830742523  | 0.00010997790578395  | 1.28225361003709e-06 |
| "380" | 0.00451481496094058 | 0.00099029432652095 | 0.000138384754990926 | 0.00739307977590152  | 0.00011865777637497  | 2.66314211315395e-06 |



